# 3Dto2D 优化系统架构设计

## 1. 核心流程设计
系统将遵循以下流水线处理 3D 模型：
1.  **数据导入与预处理**：加载带 RGB 顶点颜色的 OBJ 模型。
2.  **红线识别与结构化 (SeamExtractor.js)**：
    *   识别红色顶点。
    *   构建拓扑连接的裁线段。
    *   检测闭合回路。
3.  **基于裁线屏障的泛洪分割 (FloodSegmenter.js)**：
    *   将裁线视为不可逾越的屏障。
    *   执行面片级泛洪填充，划分独立部件。
4.  **曲面部件分类 (New Module)**：
    *   分析每个部件内部是否包含未被消耗的裁线。
    *   分类为：`含内部裁线曲面` 和 `无内部裁线曲面`。
5.  **差异化展开策略 (MeshFlattener.js & PhysicsFlattener.js)**：
    *   **含内部裁线**：执行拓扑切割（Topological Surgery），然后进行弹性展开。
    *   **无内部裁线**：选择最优投影方向，直接进行弹性展开。
6.  **弹性展开模型 (PhysicsFlattener.js)**：
    *   边界边：高刚度弹簧。
    *   内部边：低刚度弹簧。
    *   允许收缩/膨胀，不强制拉直边界。

## 2. 模块职责划分

| 模块名称 | 职责 | 状态 |
| :--- | :--- | :--- |
| `OBJParser.js` | 解析 OBJ 文件，提取顶点、面、颜色信息 | 现有，需确认颜色解析 |
| `SeamExtractor.js` | 红线识别、DBSCAN 聚类、拓扑结构化 | 现有，需增强结构化逻辑 |
| `FloodSegmenter.js` | 面片级泛洪、屏障检测、子网格构建 | 现有，需确保屏障逻辑严格 |
| `Classifier.js` | **(新增)** 部件分类逻辑 | 待实现 |
| `PhysicsFlattener.js` | 弹性展开核心算法，处理收缩/膨胀 | 现有，需优化参数 |
| `main.js` | 串联整个流程，控制 UI 与可视化 | 现有，需重构 Pipeline |

## 3. 关键技术点
*   **红线拓扑化**：不仅仅是点集，需要识别出线段和交点。
*   **弹性约束**：使用 Verlet 积分或简单的弹簧质点系统实现。
*   **投影方向选择**：基于主成分分析 (PCA) 或平均法线。
